{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}
{% load price_filters %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6">
    <h2 class="text-2xl font-bold my-4">{{ product.name }}</h2>

    <div class="flex flex-col md:flex-row gap-6">
        <!-- تصویر محصول -->
        <div class="w-full md:w-1/2">
            {% with image=product.images.first %}
                {% if image and image.image %}
                    <img src="{{ image.image.url }}" class="w-full h-96 object-cover rounded-lg shadow-md mb-3" alt="{{ product.name }}">
                {% else %}
                    <img src="{% static 'images/placeholder.jpg' %}" class="w-full h-96 object-cover rounded-lg shadow-md mb-3" alt="محصول بدون تصویر">
                {% endif %}
            {% endwith %}
        </div>

        <!-- جزئیات محصول -->
        <div class="w-full md:w-1/2">
            <div class="product-card p-6">
                <h5 class="text-xl font-semibold mb-3">{{ product.name }}</h5>

                {% if product.description %}
                    <p class="text-gray-700 leading-relaxed mb-4">{{ product.description }}</p>
                {% else %}
                    <p class="text-gray-400 italic mb-4">توضیحی برای این محصول ثبت نشده است.</p>
                {% endif %}

                <p class="text-2xl font-bold text-blue-600 mb-6">
                    <strong>قیمت:</strong> {{ product.price|price_format }}
                </p>

                <!-- کادر افزودن به سبد خرید -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg shadow-md p-6">
                    <h4 class="text-lg font-bold mb-4 text-yellow-800 flex items-center gap-2">
                        🛒 افزودن به سبد خرید
                    </h4>
                    <form method="post" action="{% url 'catalog:add_to_cart' product.id %}">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label for="quantity" class="block text-sm font-semibold text-yellow-700 mb-2">تعداد:</label>
                            <input type="number" name="quantity" id="quantity" value="1" min="1"
                                   class="w-24 p-2 border border-yellow-300 rounded focus:ring-yellow-500 focus:outline-none">
                        </div>
                        <button type="submit"
                                class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 transition duration-300">
                            افزودن به سبد خرید
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
